{"ast":null,"code":"export default {\n  props: {\n    hasFiltering: {\n      type: Boolean,\n      default: false\n    },\n    hasIcon: {\n      type: String,\n      default: \"true\"\n    },\n    items: {\n      type: Array,\n      required: true\n    },\n    title: {\n      type: String\n    },\n    fieldName: {\n      type: String,\n      default: \"name\"\n    },\n    itemDefault: {\n      type: Boolean\n    },\n    initValue: {\n      type: String\n    },\n    border: {\n      type: String\n    }\n  },\n  data() {\n    return {\n      i: -1,\n      // lưu thứ tự item trong mảng items\n      isShow: false,\n      // hiển thị danh sách drop-down\n      currentItem: {},\n      // item được chọn\n      heightOfItem: 35,\n      // chiều cao của 1 item\n      heightOfBody: 135,\n      // chiều cao chủa drop-down-body\n      dataItems: [],\n      // mảng items hiển thị\n      keyword: \"\" // từ khóa để lọc\n    };\n  },\n\n  methods: {\n    /**\r\n     * hàm xử lý sự kiện khi Blur\r\n     * Author : (06/08/2022)\r\n     */\n    onBlur() {\n      setTimeout(() => {\n        this.isShow = false;\n      }, 200);\n    },\n    /**\r\n     * khởi tạo hàm mở combobox\r\n     * Author: TTDuc (06/08/2022)\r\n     */\n    openCombobox() {\n      this.isShow = !this.isShow;\n      this.scrollToCurentItem();\n    },\n    /**\r\n     * hàm thực hiện chọn 1 items\r\n     * Author: TTDuc (24/08/2022)\r\n     */\n    onClickItem(item) {\n      try {\n        this.currentItem = item;\n        this.$emit(\"comboboxSelectedItem\", this.currentItem);\n        this.keyword = this.currentItem[this.fieldName];\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    /**\r\n     * hàm khởi tạo sự kiện keyDown\r\n     * Author: TTDuc (13/08/2022)\r\n     */\n    keyDown() {\n      try {\n        if (!this.isShow) {\n          this.isShow = true;\n        } else {\n          this.i++;\n          if (this.i > this.dataItems.length - 1) {\n            this.i = this.dataItems.length - 1;\n          }\n          this.currentItem = this.dataItems[this.i];\n          this.scrollTrackingItem((this.i - 1) * this.heightOfItem);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    /**\r\n     * hàm xử lý sự kiện key up\r\n     * Author : TTDuc (13/12/2022)\r\n     */\n    keyUp() {\n      try {\n        if (this.i > 0) {\n          this.i--;\n          this.currentItem = this.dataItems[this.i];\n          this.scrollTrackingItem((this.i - 1) * this.heightOfItem);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    /**\r\n     * hàm xử lý sự kiện scrollHeight\r\n     * Author: TTDuc (13/8/2022)\r\n     */\n    scrollTrackingItem(position) {\n      if (position >= 0) {\n        this.$el.querySelector(\".drop-down\").scrollTo(0, position);\n      }\n    },\n    /**\r\n     * hàm xử lý scroll đến item đã được chọn\r\n     * Author : TTDuc (06/08/2022)\r\n     */\n    scrollToCurentItem() {\n      this.items.filter((item, index) => {\n        if (item === this.currentItem) {\n          this.$el.querySelector(\".drop-down\").scrollTo(0, index * this.heightOfItem);\n        }\n      });\n    },\n    /**\r\n     * hàm chọn item khi nhấn enter\r\n     * Author : TTDuc(07/09/2022)\r\n     */\n    selectItem() {\n      this.$emit(\"comboboxSelectedItem\", this.currentItem);\n      this.keyword = this.currentItem[this.fieldName];\n      this.isShow = false;\n      this.i = 0;\n      this.$el.querySelector(\".input\").focus();\n      this.dataItems = this.items;\n    },\n    /**\r\n     * hàm thực hiện lọc\r\n     * Author: TTDuc (07/08/2022)\r\n     */\n    filter() {\n      if (this.hasFiltering && this.keyword != \"\") {\n        this.dataItems = this.items.filter(item => {\n          let valueFilter = item[this.fieldName].trim().toLowerCase();\n          if (valueFilter.includes(this.keyword.trim().toLowerCase())) {\n            return item;\n          }\n        });\n      } else {\n        this.dataItems = this.items;\n      }\n    },\n    /**\r\n     * hàm thực hiện chọn tất cả text\r\n     * Author: TTDuc (07/09/2022)\r\n     */\n    onFocus() {\n      try {\n        if (this.hasFiltering) {\n          this.$el.querySelector(\".input\").select();\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    }\n  },\n  created() {\n    // kiểm tra nếu cần có item mặc định thì lấy item 0\n    if (this.items && this.itemDefault) {\n      this.currentItem = this.items[0];\n    }\n    for (const item of this.items) {\n      if (item[this.fieldName] == this.initValue) {\n        this.currentItem = item;\n      }\n    }\n    if (!this.hasFiltering) {\n      this.keyword = this.currentItem[this.fieldName];\n    }\n    this.dataItems = this.items;\n  },\n  watch: {\n    keyword() {\n      if (this.keyword == \"\") {\n        this.isShow = false;\n        this.currentItem = {};\n        this.$emit(\"comboboxSelectedItem\", this.currentItem);\n      }\n      this.filter();\n    }\n  }\n};","map":{"version":3,"names":["props","hasFiltering","type","Boolean","default","hasIcon","String","items","Array","required","title","fieldName","itemDefault","initValue","border","data","i","isShow","currentItem","heightOfItem","heightOfBody","dataItems","keyword","methods","onBlur","setTimeout","openCombobox","scrollToCurentItem","onClickItem","item","$emit","err","console","log","keyDown","length","scrollTrackingItem","error","keyUp","position","$el","querySelector","scrollTo","filter","index","selectItem","focus","valueFilter","trim","toLowerCase","includes","onFocus","select","created","watch"],"sources":["D:\\dhtl\\ptda\\QLNS\\ui\\src\\components\\base\\BaseCombobox.vue"],"sourcesContent":["<template>\r\n    <div\r\n      class=\"m-combobox\"\r\n      :class=\"hasIcon === 'false' ? 'm-combobox-mini' : ''\"\r\n      @click=\"openCombobox\"\r\n      @keyup.enter=\"selectItem\"\r\n      @keyup.down.stop=\"keyDown\"\r\n      @keyup.up.stop=\"keyUp\"\r\n    >\r\n      <div class=\"icon\" v-if=\"hasFiltering\">\r\n        <div class=\"icon-filter\"></div>\r\n      </div>\r\n  \r\n      <input\r\n        class=\"input\"\r\n        type=\"text\"\r\n        v-model=\"keyword\"\r\n        :placeholder=\"title\"\r\n        @blur=\"onBlur\"\r\n        :readonly=\"!hasFiltering\"\r\n        @focus=\"onFocus\"\r\n        :class=\"border\"\r\n      />\r\n  \r\n      <div class=\"up-down\">\r\n        <div class=\"down\">\r\n          <div class=\"btn icon-down-bold\"></div>\r\n        </div>\r\n      </div>\r\n  \r\n      <div class=\"drop-down\" v-show=\"isShow\">\r\n        <div\r\n          class=\"drop-down-item\"\r\n          v-for=\"item in dataItems\"\r\n          :key=\"item\"\r\n          :class=\"item == currentItem ? 'active' : ''\"\r\n          @click=\"onClickItem(item)\"\r\n        >\r\n          {{ item[fieldName] }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  export default {\r\n    props: {\r\n      hasFiltering: {\r\n        type: Boolean,\r\n        default: false,\r\n      },\r\n      hasIcon: {\r\n        type: String,\r\n        default: \"true\",\r\n      },\r\n      items: {\r\n        type: Array,\r\n        required: true,\r\n      },\r\n      title: {\r\n        type: String,\r\n      },\r\n      fieldName: {\r\n        type: String,\r\n        default: \"name\",\r\n      },\r\n      itemDefault: {\r\n        type: Boolean,\r\n      },\r\n      initValue: {\r\n        type: String,\r\n      },\r\n      border: {\r\n        type: String,\r\n      },\r\n    },\r\n    data() {\r\n      return {\r\n        i: -1, // lưu thứ tự item trong mảng items\r\n        isShow: false, // hiển thị danh sách drop-down\r\n        currentItem: {}, // item được chọn\r\n        heightOfItem: 35, // chiều cao của 1 item\r\n        heightOfBody: 135, // chiều cao chủa drop-down-body\r\n        dataItems: [], // mảng items hiển thị\r\n        keyword: \"\", // từ khóa để lọc\r\n      };\r\n    },\r\n    methods: {\r\n      /**\r\n       * hàm xử lý sự kiện khi Blur\r\n       * Author : (06/08/2022)\r\n       */\r\n      onBlur() {\r\n        setTimeout(() => {\r\n          this.isShow = false;\r\n        }, 200);\r\n      },\r\n      /**\r\n       * khởi tạo hàm mở combobox\r\n       * Author: TTDuc (06/08/2022)\r\n       */\r\n      openCombobox() {\r\n        this.isShow = !this.isShow;\r\n        this.scrollToCurentItem();\r\n      },\r\n      /**\r\n       * hàm thực hiện chọn 1 items\r\n       * Author: TTDuc (24/08/2022)\r\n       */\r\n      onClickItem(item) {\r\n        try {\r\n          this.currentItem = item;\r\n          this.$emit(\"comboboxSelectedItem\", this.currentItem);\r\n          this.keyword = this.currentItem[this.fieldName];\r\n        } catch (err) {\r\n          console.log(err);\r\n        }\r\n      },\r\n      /**\r\n       * hàm khởi tạo sự kiện keyDown\r\n       * Author: TTDuc (13/08/2022)\r\n       */\r\n      keyDown() {\r\n        try {\r\n          if (!this.isShow) {\r\n            this.isShow = true;\r\n          } else {\r\n            this.i++;\r\n            if (this.i > this.dataItems.length - 1) {\r\n              this.i = this.dataItems.length - 1;\r\n            }\r\n            this.currentItem = this.dataItems[this.i];\r\n            this.scrollTrackingItem((this.i - 1) * this.heightOfItem);\r\n          }\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      },\r\n      /**\r\n       * hàm xử lý sự kiện key up\r\n       * Author : TTDuc (13/12/2022)\r\n       */\r\n      keyUp() {\r\n        try {\r\n          if (this.i > 0) {\r\n            this.i--;\r\n            this.currentItem = this.dataItems[this.i];\r\n            this.scrollTrackingItem((this.i - 1) * this.heightOfItem);\r\n          }\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      },\r\n      /**\r\n       * hàm xử lý sự kiện scrollHeight\r\n       * Author: TTDuc (13/8/2022)\r\n       */\r\n      scrollTrackingItem(position) {\r\n        if (position >= 0) {\r\n          this.$el.querySelector(\".drop-down\").scrollTo(0, position);\r\n        }\r\n      },\r\n      /**\r\n       * hàm xử lý scroll đến item đã được chọn\r\n       * Author : TTDuc (06/08/2022)\r\n       */\r\n      scrollToCurentItem() {\r\n        this.items.filter((item, index) => {\r\n          if (item === this.currentItem) {\r\n            this.$el\r\n              .querySelector(\".drop-down\")\r\n              .scrollTo(0, index * this.heightOfItem);\r\n          }\r\n        });\r\n      },\r\n      /**\r\n       * hàm chọn item khi nhấn enter\r\n       * Author : TTDuc(07/09/2022)\r\n       */\r\n      selectItem() {\r\n        this.$emit(\"comboboxSelectedItem\", this.currentItem);\r\n        this.keyword = this.currentItem[this.fieldName];\r\n        this.isShow = false;\r\n  \r\n        this.i = 0;\r\n        this.$el.querySelector(\".input\").focus();\r\n        this.dataItems = this.items;\r\n      },\r\n      /**\r\n       * hàm thực hiện lọc\r\n       * Author: TTDuc (07/08/2022)\r\n       */\r\n      filter() {\r\n        if (this.hasFiltering && this.keyword != \"\") {\r\n          this.dataItems = this.items.filter((item) => {\r\n            let valueFilter = item[this.fieldName].trim().toLowerCase();\r\n            if (valueFilter.includes(this.keyword.trim().toLowerCase())) {\r\n              return item;\r\n            }\r\n          });\r\n        } else {\r\n          this.dataItems = this.items;\r\n        }\r\n      },\r\n      /**\r\n       * hàm thực hiện chọn tất cả text\r\n       * Author: TTDuc (07/09/2022)\r\n       */\r\n      onFocus() {\r\n        try {\r\n          if (this.hasFiltering) {\r\n            this.$el.querySelector(\".input\").select();\r\n          }\r\n        } catch (err) {\r\n          console.log(err);\r\n        }\r\n      },\r\n    },\r\n    created() {\r\n      // kiểm tra nếu cần có item mặc định thì lấy item 0\r\n      if (this.items && this.itemDefault) {\r\n        this.currentItem = this.items[0];\r\n      }\r\n  \r\n      for (const item of this.items) {\r\n        if (item[this.fieldName] == this.initValue) {\r\n          this.currentItem = item;\r\n        }\r\n      }\r\n  \r\n      if (!this.hasFiltering) {\r\n        this.keyword = this.currentItem[this.fieldName];\r\n      }\r\n  \r\n      this.dataItems = this.items;\r\n    },\r\n    watch: {\r\n      keyword() {\r\n        if (this.keyword == \"\") {\r\n          this.isShow = false;\r\n          this.currentItem = {};\r\n          this.$emit(\"comboboxSelectedItem\", this.currentItem);\r\n        }\r\n  \r\n        this.filter();\r\n      },\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  @import url(../../css/layout/combobox.css);\r\n  </style>\r\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}